<! -- -*- tcl -*- doctools manpage
   -->
<html><head>
<title>midi - Midi file, track and event handling </title>
</head>
<! -- Generated from file 'midi.man' by tcllib/doctools with format 'html'
   -->
<! -- Copyright &copy; 2006-2008 Jos Decoster &lt;jos.decoster@gmail.com&gt;
   -->
<! -- CVS: $Id$ midi.n
   -->

<body>
<h1> midi(n) 0.11  &quot;Midi file, track and event handling&quot;</h1>
<h2><a name="name">NAME</a></h2>
<p>
<p> midi - Package to handle midi files, tracks and events




<h2><a name="synopsis">SYNOPSIS</a></h2>
<p>
package require <b>Tcl 8.4</b><br>
<br><table border=1 width=100% cellspacing=0 cellpadding=0><tr            bgcolor=lightyellow><td bgcolor=lightyellow><table 0 width=100% cellspacing=0 cellpadding=0><tr valign=top ><td ><a href="#1"><b class='cmd'>midi::file</b> ?<i class='arg'>options</i>? ...</a></td></tr>
<tr valign=top ><td ><a href="#2"><i class='arg'>midiFileId</i> <strong>destroy</strong></a></td></tr>
<tr valign=top ><td ><a href="#3"><i class='arg'>midiFileId</i> <strong>reset</strong></a></td></tr>
<tr valign=top ><td ><a href="#4"><i class='arg'>midiFileId</i> <strong>validate</strong></a></td></tr>
<tr valign=top ><td ><a href="#5"><i class='arg'>midiFileId</i> <strong>validate_option</strong> <i class='arg'>option</i> <i class='arg'>value</i></a></td></tr>
<tr valign=top ><td ><a href="#6"><i class='arg'>midiFileId</i> <strong>cget</strong> <i class='arg'>option</i></a></td></tr>
<tr valign=top ><td ><a href="#7"><i class='arg'>midiFileId</i> <strong>configure</strong></a></td></tr>
<tr valign=top ><td ><a href="#8"><i class='arg'>midiFileId</i> <strong>configure</strong> <i class='arg'>option</i></a></td></tr>
<tr valign=top ><td ><a href="#9"><i class='arg'>midiFileId</i> <strong>configure</strong> <i class='arg'>option value</i> ...</a></td></tr>
<tr valign=top ><td ><a href="#10"><i class='arg'>midiFileId</i> <strong>read</strong> <i class='arg'>fileName</i></a></td></tr>
<tr valign=top ><td ><a href="#11"><i class='arg'>midiFileId</i> <strong>write</strong> <i class='arg'>fileName</i> ?<i class='arg'>option value ...</i>?</a></td></tr>
<tr valign=top ><td ><a href="#12"><i class='arg'>midiFileId</i> <strong>dump</strong> ?<i class='arg'>option value ...</i>?</a></td></tr>
<tr valign=top ><td ><a href="#13"><i class='arg'>midiFileId</i> <strong>flatten</strong> ?<i class='arg'>option value ...</i>?</a></td></tr>
<tr valign=top ><td ><a href="#14"><i class='arg'>midiFileId</i> <strong>clicks</strong> <i class='arg'>noteLength</i></a></td></tr>
<tr valign=top ><td ><a href="#15"><i class='arg'>midiFileId</i> <strong>measure</strong> ?<i class='arg'>option value ...</i>?</a></td></tr>
<tr valign=top ><td ><a href="#16"><b class='cmd'>midi::track</b> ?<i class='arg'>options</i>? ...</a></td></tr>
<tr valign=top ><td ><a href="#17"><i class='arg'>midiTrackId</i> <strong>destroy</strong></a></td></tr>
<tr valign=top ><td ><a href="#18"><i class='arg'>midiTrackId</i> <strong>reset</strong></a></td></tr>
<tr valign=top ><td ><a href="#19"><i class='arg'>midiTrackId</i> <strong>validate</strong></a></td></tr>
<tr valign=top ><td ><a href="#20"><i class='arg'>midiTrackId</i> <strong>validate_option</strong> <i class='arg'>option</i> <i class='arg'>value</i></a></td></tr>
<tr valign=top ><td ><a href="#21"><i class='arg'>midiTrackId</i> <strong>cget</strong> <i class='arg'>option</i></a></td></tr>
<tr valign=top ><td ><a href="#22"><i class='arg'>midiTrackId</i> <strong>configure</strong></a></td></tr>
<tr valign=top ><td ><a href="#23"><i class='arg'>midiTrackId</i> <strong>configure</strong> <i class='arg'>option</i></a></td></tr>
<tr valign=top ><td ><a href="#24"><i class='arg'>midiTrackId</i> <strong>configure</strong> <i class='arg'>option value</i> ...</a></td></tr>
<tr valign=top ><td ><a href="#25"><i class='arg'>midiTrackId</i> <strong>dump</strong></a></td></tr>
<tr valign=top ><td ><a href="#26"><b class='cmd'>midi::event</b> <i class='arg'>type</i> ?<i class='arg'>options</i>? ...</a></td></tr>
<tr valign=top ><td ><a href="#27"><b class='cmd'>midi::event::reset</b> <i class='arg'>intList</i></a></td></tr>
<tr valign=top ><td ><a href="#28"><b class='cmd'>midi::event::validate</b> <i class='arg'>intList</i></a></td></tr>
<tr valign=top ><td ><a href="#29"><b class='cmd'>midi::event::validate_option</b> <i class='arg'>intList</i> ?<i class='arg'>options</i>? ...</a></td></tr>
<tr valign=top ><td ><a href="#30"><b class='cmd'>midi::event::cget</b> <i class='arg'>intList</i> <i class='arg'>option</i></a></td></tr>
<tr valign=top ><td ><a href="#31"><b class='cmd'>midi::event::configure</b> <i class='arg'>intList</i></a></td></tr>
<tr valign=top ><td ><a href="#32"><b class='cmd'>midi::event::configure</b> <i class='arg'>intList</i> <i class='arg'>option</i></a></td></tr>
<tr valign=top ><td ><a href="#33"><b class='cmd'>midi::event::configure</b> <i class='arg'>intList</i> <i class='arg'>option value</i> ...</a></td></tr>
<tr valign=top ><td ><a href="#34"><b class='cmd'>midi::event::type</b> <i class='arg'>intList</i></a></td></tr>
<tr valign=top ><td ><a href="#35"><b class='cmd'>midi::event::type_meta_event</b> <i class='arg'>intList</i></a></td></tr>
<tr valign=top ><td ><a href="#36"><b class='cmd'>midi::event::dump</b> <i class='arg'>intList</i></a></td></tr>
</table></td></tr></table>
<h2><a name="description">DESCRIPTION</a></h2>
<p>
<p>

This page describes the Tcl <strong>midi</strong> package to process midi files. The
commands to read, write, create and edit midi files are discussed here.

<p>

The <strong>midi</strong> package adds the namespace midi to the Tcl
interpreter in which it is loaded. In this namespace, the main commands to
work with midi files are created:

<dl>
<dt>midi::file<dd>
<dt>midi::track<dd>
<dt>midi::event<dd>
</dl>

<p> 

The file and track commands have an object interface, much like Tk
widgets. Midi events are represented as a list of integers.

<h2><a name="midifile">midi::file</a></h2>
<p>

<dl>

<dt><a name="1"><b class='cmd'>midi::file</b> ?<i class='arg'>options</i>? ...</a><dd>


This command will create a midi file object and returns a unique midi file
id. This id should be used to manipulate the midi file later on. Known options
are: 

<br><br>
<dl>

<dt><strong>-type</strong> integer<dd>

Set the midi file type. Must be <strong>0</strong>, <strong>1</strong> or <strong>2</strong>. Default value is 1.

<br><br>
<dt><strong>-time_division_type</strong> string<dd>

Set the time divisiob type used in the midi file. Must be 
<strong>ticks_per_beat</strong> or <strong>frames_per_second</strong>. Default values is <strong>ticks_per_beat</strong>.

<br><br>
<dt><strong>-ticks_per_beat</strong> integer<dd>

Sets the number of ticks per beat (quarter note), only used when the time 
division type is <strong>ticks_per_beat</strong>. Default value is 480.

<br><br>
<dt><strong>-frames_per_second</strong> integer<dd>

Set the number of frames per second, only used when the time division type is 
<strong>frames_per_second</strong>. Default value is -1.

<br><br>
<dt><strong>-ticks_per_frame</strong> integer<dd>

Set the number of ticks per frame, only used when the time division type is 
<strong>frames_per_second</strong>. Default value is -1.

<br><br>
<dt><strong>-tracks</strong> listOfTrackIds<dd>

Set the track to be included in the midi file. The tracks must be specified as
a list of tracks id's obtained by calling the <b class='cmd'>midi::track</b> command. By default, no tracks are added.

<br><br>
<dt><strong></strong><dd>

</dl>

<dt><a name="2"><i class='arg'>midiFileId</i> <strong>destroy</strong></a><dd>


Reset and destroy a midi file object.

<br><br>
<dt><a name="3"><i class='arg'>midiFileId</i> <strong>reset</strong></a><dd>


Reset a midi file object. Resetting a midi file object will clear the type and
timing information and destroy all tracks (with reference count zero) of the
midi file.

<br><br>
<dt><a name="4"><i class='arg'>midiFileId</i> <strong>validate</strong></a><dd>


Validates a midi file object, including the tracks. Only the options required
for a specific time division type are checked.

<br><br>
<dt><a name="5"><i class='arg'>midiFileId</i> <strong>validate_option</strong> <i class='arg'>option</i> <i class='arg'>value</i></a><dd>


Validates a midi file object-option value. All options will be validated, even
if a specified option is not necessary according to the time division type. All
options accepted by the <b class='cmd'>midi::file</b> command can be specified.

<br><br>
<dt><a name="6"><i class='arg'>midiFileId</i> <strong>cget</strong> <i class='arg'>option</i></a><dd>


Returns the current value of the configuration option given by <i class='arg'>option</i>. 
<i class='arg'>Option</i> may have any of the values accepted by the 
<b class='cmd'>midi::file</b> command.

<br><br>
<dt><a name="7"><i class='arg'>midiFileId</i> <strong>configure</strong></a><dd>


Returns a list describing all of the available options. The returned list
contains a sublist for each known option with the following elements: the
option, the default value and the current value. Information is returned for
all options accepted by the <b class='cmd'>midi::file</b> command.

<br><br>
<dt><a name="8"><i class='arg'>midiFileId</i> <strong>configure</strong> <i class='arg'>option</i></a><dd>


Returns list describing the named option. <i class='arg'>Option</i> may have any of the
values accepted by the <b class='cmd'>midi::file</b> command. The returned list contains 3
elements: the option, the default value and the current value.

<br><br>
<dt><a name="9"><i class='arg'>midiFileId</i> <strong>configure</strong> <i class='arg'>option value</i> ...</a><dd>


Modifies the given midi file option(s) to have the given value(s). The command
returns an empty string. <i class='arg'>Option</i> may have any of the values accepted by
the <b class='cmd'>midi::file</b> command.

<br><br>
<dt><a name="10"><i class='arg'>midiFileId</i> <strong>read</strong> <i class='arg'>fileName</i></a><dd>


Reads the specified midi file into the midi file object.

<br><br>
<dt><a name="11"><i class='arg'>midiFileId</i> <strong>write</strong> <i class='arg'>fileName</i> ?<i class='arg'>option value ...</i>?</a><dd>


Writes the contents of the midi file object into the specified file. Known
options are:

<br><br>
<dl>

<dt><strong>-running_status</strong> boolean<dd>

If set to true, the midi file will be written with running status, making the
resulting output file smaller. If set to false (default), the midi file will be
written without running status.

<br><br>
<dt><strong>-tracks</strong> listOfTrackIds<dd>

Only write the specified tracks to the output file.

<br><br>
<dt><strong></strong><dd>

</dl>

<dt><a name="12"><i class='arg'>midiFileId</i> <strong>dump</strong> ?<i class='arg'>option value ...</i>?</a><dd>


Writes a textual representation of the midi file object contents into the file
specified with the -file option. If no file is specified, returns the textual
representation of the midi file as a string. Known options are:

<br><br>
<dl>

<dt><strong>-file</strong> path<dd>

Dump the midi file to the specified output file.

<br><br>
<dt><strong>-tracks</strong> listOfTrackIds<dd>

Only dump the specified tracks.

<br><br>
<dt><strong></strong><dd>

</dl>

<dt><a name="13"><i class='arg'>midiFileId</i> <strong>flatten</strong> ?<i class='arg'>option value ...</i>?</a><dd>


Creates a one track representation of a multi track midi file. This command
will return a list of two element lists. The first element in each sub-list
contains the delta time until the event associated with it can be
processed. The second element in each sub-list contains a list of events,
represented as lists of integers. Known options are:

<br><br>
<dl>

<dt><strong>-include_meta</strong> listOfMetaEventTypes<dd>

Only include Meta events of specified types in the flattened
output. Check <b class='cmd'>midi::event::type_meta_event</b> for known Meta event
types.

<br><br>
<dt><strong>-no_meta</strong> boolean<dd>

Do not include Meta events in the flattened output.

<br><br>
<dt><strong>-no_sys_ex</strong> boolean<dd>

Do not include SysEx events in the flattened output.

<br><br>
<dt><strong>-tracks</strong> listOfTrackIds<dd>

Only flatten the specified tracks.

<br><br>
<dt><strong></strong><dd>

</dl>

<dt><a name="14"><i class='arg'>midiFileId</i> <strong>clicks</strong> <i class='arg'>noteLength</i></a><dd>


Calculates the length of a note in clicks for common note lengths. Lengths 
understood by this method are: <strong>1</strong>, <strong>1.</strong>, <strong>1/2</strong>, 
<strong>1/2.</strong>, <strong>1/2t</strong>, <strong>1/4</strong>, <strong>1/4.</strong>, <strong>1/4t</strong>, 
<strong>1/8</strong>, <strong>1/8.</strong>, <strong>1/8t</strong>, <strong>1/16</strong>, <strong>1/16.</strong>, 
<strong>1/16t</strong>, <strong>1/32</strong>, <strong>1/32.</strong>, <strong>1/32t</strong>, <strong>1/64</strong>, 
<strong>1/64.</strong> and <strong>1/64t.</strong>  Lengths with a <strong>.</strong> (dot) add half of 
the length to the fraction, lengths with a <strong>t</strong> are used for triplets. 
This functions can only be used when the <strong>-time_division_type</strong> option is
set to <strong>ticks_per_beat</strong> and the <strong>-ticks_per_beat</strong> option has been 
initialised.

<br><br>
<dt><a name="15"><i class='arg'>midiFileId</i> <strong>measure</strong> ?<i class='arg'>option value ...</i>?</a><dd>


This command can be used to generate event list from a simplied input format. By
only specifying note names and durations, an event list suitable for midi-tracks
can be obtained. This command will only generate note-on and note-off event,
other event still need to be added to the event list with the <b class='cmd'>midi::event</b>
command. Only a list of non-overlapping notes can be specified. It durations of
notes overlap, create different event-lists with multiple calls to this command
and later on merge the resulting event lists with the <b class='cmd'>midi::merge</b> command.

<br><br>
<dl>

<dt><strong>-channel</strong> integer<dd> Channel on which to play the specified notes.

<br><br>
<dt><strong>-events</strong> listOfListOfNotes<dd> A list of note-lists. Each such note-list
contains a duration, a list of notes and optionally a velocity. A duration must
be specified as a note-length understood by the <b class='cmd'>midi::file::clicks</b>
method. Notes can be specified using their midi note-number or their
note-name. Check the <a href="#notes">Notes</a> section for valid note numbers and valid
note names. In addition to the notes found in that section, it is possible to
use <strong>r</strong> or <strong>R</strong> to specify a rest. The optional velocity must be an
integer in the range 0..127. Default value is 127.

The following example show how to generate an event list of a C-major scale
played as quarter notes and followed by a C-major chord on channel 4:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
set mf [midi::file -type 1 -time_division_type ticks_per_beat -ticks_per_beat 480]
set el [$mf measure -channel 4 -events {{1/4 C5} {1/4 D5} {1/4 E5} {1/4 F5} {1/4 G5} {1/4 A5} {1/4 B5} {1/4 C6} {1/1 {C5 E5 G5 C6}}}]
</pre></td></tr></table></p>

Check the <a href="#examples">Examples</a> sections for more examples of using this method.

<br><br>
<dt><strong></strong><dd>

</dl>

</dl>

<h2><a name="miditrack">midi::track</a></h2>
<p>

<dl>

<dt><a name="16"><b class='cmd'>midi::track</b> ?<i class='arg'>options</i>? ...</a><dd>


This command will create a midi track object and return a unique midi track
id. This id should be used to manipulate the midi track later on. Known options
are:

<br><br>
<dl>

<dt><strong>-events</strong> listOfEvents<dd>

Specifies a list of events with associated delta-time for the midi track. An
event with its associated delta-time is represented as a list of the delta-time
and a list of integers representing the event. By default, no events are added 
to a track. A delta time specifies the time to wait before processing the 
associated event. A delta time is expressed in clock ticks. When using 
<strong>ticks_per_beat</strong> as time division type, the duration of a note can be 
calculated based on the specified ticks per beat. When 480 clock clicks are 
required for a quarter note, the length in clicks of other note lengths is as 
follows: 

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
lengthInClicks = 480.0 * 4 * length
</pre></td></tr></table></p>

Using this function, the lengths of different notes can be calculated:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
length length in clicks
------ ----------------
1                  1920
1/2                 960
1/4                 480
1/8                 240
1/16                120
1/32                 60
1/64                 30
</pre></td></tr></table></p>

The <b class='cmd'>midi::file::clicks</b> method can be used to calculate lengths in clicks 
for common note lengths.

<br><br>
<dt><strong></strong><dd>

</dl>

<dt><a name="17"><i class='arg'>midiTrackId</i> <strong>destroy</strong></a><dd>


Reset and destroy a midi track object.

<br><br>
<dt><a name="18"><i class='arg'>midiTrackId</i> <strong>reset</strong></a><dd>


Reset a midi track object. Resetting a midi track object removes all events
from the midi track.

<br><br>
<dt><a name="19"><i class='arg'>midiTrackId</i> <strong>validate</strong></a><dd>


Validates a midi track object, including the events.

<br><br>
<dt><a name="20"><i class='arg'>midiTrackId</i> <strong>validate_option</strong> <i class='arg'>option</i> <i class='arg'>value</i></a><dd>


Validates a midi track object option value. All options accepted by the 
<b class='cmd'>midi::track</b> command can be specified.

<br><br>
<dt><a name="21"><i class='arg'>midiTrackId</i> <strong>cget</strong> <i class='arg'>option</i></a><dd>


Returns the current value of the configuration option given by <i class='arg'>option</i>. 
<i class='arg'>Option</i> may have any of the values accepted by the 
<b class='cmd'>midi::track</b> command.

<br><br>
<dt><a name="22"><i class='arg'>midiTrackId</i> <strong>configure</strong></a><dd>


Returns a list describing all of the available options. The returned list
contains a sublist for each known option with the following elements: the
option, the default value and the current value. Information is returned for
all options accepted by the <b class='cmd'>midi::track</b> command.

<br><br>
<dt><a name="23"><i class='arg'>midiTrackId</i> <strong>configure</strong> <i class='arg'>option</i></a><dd>


Returns list describing the named option. <i class='arg'>Option</i> may have any of the
values accepted by the <b class='cmd'>midi::track</b> command. The returned list contains 3
elements: the option, the default value and the current value.

<br><br>
<dt><a name="24"><i class='arg'>midiTrackId</i> <strong>configure</strong> <i class='arg'>option value</i> ...</a><dd>


Modifies the given midi track option(s) to have the given value(s). The command
returns an empty string. <i class='arg'>Option</i> may have any of the values accepted by
the <b class='cmd'>midi::track</b> command.

<br><br>
<dt><a name="25"><i class='arg'>midiTrackId</i> <strong>dump</strong></a><dd>


Returns a textual representation of the midi track.

</dl>

<h2><a name="midievent">midi::event</a></h2>
<p>

Events are represented as a list of integers. Each integer contains the value
of a byte in the binary midi event as stored in a midi file. The commands
listed below make it easier to create and manipulate midi events. These 
commands offer a configure interface. Supported events with associated options 
can be found in the <a href="#events">Events</a> section.

<dl>

<dt><a name="26"><b class='cmd'>midi::event</b> <i class='arg'>type</i> ?<i class='arg'>options</i>? ...</a><dd>
 

Creates a new event of the specified type. Check the <a href="#events">Events</a> section
for valid event types and associated options. The newly created event is
returned as a list of integers. This list must be specified with the other
event commands or when adding events to a track.
 
<br><br>
<dt><a name="27"><b class='cmd'>midi::event::reset</b> <i class='arg'>intList</i></a><dd>

 
This command returns a list of integers for an event of the same type but with
all option values set to their defautl values.

<br><br>
<dt><a name="28"><b class='cmd'>midi::event::validate</b> <i class='arg'>intList</i></a><dd>
 

Checks if the specified list of integers is a valid event. 

<br><br>
<dt><a name="29"><b class='cmd'>midi::event::validate_option</b> <i class='arg'>intList</i> ?<i class='arg'>options</i>? ...</a><dd>
 

Validates a midi event object option value. All options accepted by the 
midi event type can be specified.

<br><br>
<dt><a name="30"><b class='cmd'>midi::event::cget</b> <i class='arg'>intList</i> <i class='arg'>option</i></a><dd>


Returns the current value of the configuration option given by <i class='arg'>option</i>. 
<i class='arg'>Option</i> may have any of the values accepted by the event type.
 
<br><br>
<dt><a name="31"><b class='cmd'>midi::event::configure</b> <i class='arg'>intList</i></a><dd>


Returns a list describing all of the available options for the type of the
specified event. The returned list contains a sublist for each known option
with the following elements: the option, the default value and the current
value.
 
<br><br>
<dt><a name="32"><b class='cmd'>midi::event::configure</b> <i class='arg'>intList</i> <i class='arg'>option</i></a><dd>


Returns list describing the named option. <i class='arg'>Option</i> may have any of the
values accepted by the event type. The returned list contains 3 elements: the
option, the default value and the current value.
 
<br><br>
<dt><a name="33"><b class='cmd'>midi::event::configure</b> <i class='arg'>intList</i> <i class='arg'>option value</i> ...</a><dd>

 
Modifies the given midi event option(s) to have the given value(s). The command
returns an empty string. <i class='arg'>Option</i> may have any of the values accepted by
the event type.

<br><br>
<dt><a name="34"><b class='cmd'>midi::event::type</b> <i class='arg'>intList</i></a><dd>

 
Return the type of the specified event. Possible return values are: 
<strong>note_off</strong> <strong>note_on</strong> <strong>note_aftertouch</strong> <strong>controller</strong>
<strong>program_change</strong> <strong>channel_aftertouch</strong> <strong>pitch_bend</strong> 
<strong>Meta</strong> <strong>SysEx</strong>

<br><br>
<dt><a name="35"><b class='cmd'>midi::event::type_meta_event</b> <i class='arg'>intList</i></a><dd>


Returns meta event type. Possible return values are: 
<strong>sequence_number</strong> <strong>copyright</strong> <strong>track_name</strong> 
<strong>instrument_name</strong> <strong>lyric</strong> <strong>marker</strong> <strong>cue_point</strong>
<strong>program_name</strong> <strong>device_name</strong> <strong>channel</strong> <strong>port</strong> 
<strong>end_of_track</strong> <strong>tempo</strong> <strong>smpte_offset</strong> <strong>time_signature</strong> 
<strong>key_signature</strong> <strong>sequencer_specific</strong> <strong>meta_unknown</strong>

<br><br>
<dt><a name="36"><b class='cmd'>midi::event::dump</b> <i class='arg'>intList</i></a><dd>


Returns a textual representation of the midi event.

</dl>

<h2><a name="examples">Examples</a></h2>
<p>

The following example creates a midi file with 4 tracks. All events are
generated using the <b class='cmd'>midi::event</b> command.

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
package require midi

# Create midi file and initialise time division info
set mf [midi::file -type 1 -time_division_type ticks_per_beat -ticks_per_beat 480]

# Control track
set t1el {}
lappend t1el [list 0 [midi::event text -value &quot;control track&quot;]]
lappend t1el [list 0 [midi::event tempo -tempo 0X7A120]] ;# 120 Beats per minute
lappend t1el [list 0 [midi::event end_of_track]]
set t1 [midi::track -events $t1el]

# Piano track
set t2el {}
lappend t2el [list 0 [midi::event text -value &quot;Piano track&quot;]]
lappend t2el [list 0 [midi::event program_change -channel 0 -program &quot;Electric Piano 2&quot;]]

lappend t2el [list 0                [midi::event note_on  -channel 0 -note C4 -velocity 127]]
lappend t2el [list [$mf clicks 1/1] [midi::event note_off -channel 0 -note C4 -velocity 127]]

lappend t2el [list 0                [midi::event note_on  -channel 0 -note E4 -velocity 127]]
lappend t2el [list [$mf clicks 1/1] [midi::event note_off -channel 0 -note E4 -velocity 127]]

lappend t2el [list 0                [midi::event note_on  -channel 0 -note G4 -velocity 127]]
lappend t2el [list [$mf clicks 1/1] [midi::event note_off -channel 0 -note G4 -velocity 127]]

lappend t2el [list 0                [midi::event note_on  -channel 0 -note C5 -velocity 127]]
lappend t2el [list [$mf clicks 1/1] [midi::event note_off -channel 0 -note C5 -velocity 127]]

lappend t2el [list 0                [midi::event note_on  -channel 0 -note C4 -velocity 127]]
lappend t2el [list 0                [midi::event note_on  -channel 0 -note E4 -velocity 127]]
lappend t2el [list 0                [midi::event note_on  -channel 0 -note G4 -velocity 127]]
lappend t2el [list 0                [midi::event note_on  -channel 0 -note C5 -velocity 127]]
lappend t2el [list [$mf clicks 1/1] [midi::event note_off -channel 0 -note C4 -velocity 127]]
lappend t2el [list 0                [midi::event note_off -channel 0 -note E4 -velocity 127]]
lappend t2el [list 0                [midi::event note_off -channel 0 -note G4 -velocity 127]]
lappend t2el [list 0                [midi::event note_off -channel 0 -note C5 -velocity 127]]

lappend t2el [list 0                [midi::event end_of_track]]
set t2 [midi::track -events $t2el]

# Bass track
set t3el {}
lappend t3el [list 0 [midi::event text -value &quot;Bass track&quot;]]
lappend t3el [list 0 [midi::event program_change -channel 1 -program &quot;Electric Bass(pick)&quot;]]

lappend t3el [list 0                [midi::event note_on  -channel 1 -note C2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note C2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note D2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note D2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note E2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note E2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note F2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note F2 -velocity 127]]

lappend t3el [list 0                [midi::event note_on  -channel 1 -note E2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note E2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note F2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note F2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note G2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note G2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note A2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note A2 -velocity 127]]

lappend t3el [list 0                [midi::event note_on  -channel 1 -note G2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note G2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note A2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note A2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note B2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note B2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note C3 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note C3 -velocity 127]]

lappend t3el [list 0                [midi::event note_on  -channel 1 -note C3 -velocity 127]]
lappend t3el [list [$mf clicks 1/2] [midi::event note_off -channel 1 -note C3 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note G2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note G2 -velocity 127]]
lappend t3el [list 0                [midi::event note_on  -channel 1 -note E2 -velocity 127]]
lappend t3el [list [$mf clicks 1/4] [midi::event note_off -channel 1 -note E2 -velocity 127]]

lappend t3el [list 0        [midi::event note_on  -channel 1 -note C2 -velocity 127]]
lappend t3el [list [$mf clicks 1/1]   [midi::event note_off -channel 1 -note C2 -velocity 127]]

lappend t3el [list 0 [midi::event end_of_track]]
set t3 [midi::track -events $t3el]

# Drum track
set t4el {}
lappend t4el [list 0 [midi::event text -value &quot;Drum track&quot;]]

lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;acoustic bass drum&quot; -velocity 127]]
lappend t4el [list [$mf clicks 1/4] [midi::event note_off -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
lappend t4el [list [$mf clicks 1/4] [midi::event note_off -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;acoustic snare&quot;     -velocity 127]]
lappend t4el [list [$mf clicks 1/4] [midi::event note_off -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]

for { set i 0 } { $i &lt; 4 } { incr i } {
    lappend t4el [list [$mf clicks 1/4] [midi::event note_off -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
    lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
    lappend t4el [list 0                [midi::event note_off -channel 9 -note &quot;acoustic bass drum&quot; -velocity 127]]
    lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;acoustic bass drum&quot; -velocity 127]]
    lappend t4el [list [$mf clicks 1/4] [midi::event note_off -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
    lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
    lappend t4el [list [$mf clicks 1/4] [midi::event note_off -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
    lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
    lappend t4el [list 0                [midi::event note_off -channel 9 -note &quot;acoustic snare&quot;     -velocity 127]]
    lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;acoustic snare&quot;     -velocity 127]]
    lappend t4el [list [$mf clicks 1/4] [midi::event note_off -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
    lappend t4el [list 0                [midi::event note_on  -channel 9 -note &quot;closed hi-hat&quot;      -velocity 127]]
}

lappend t4el [list 0 [midi::event end_of_track]]
set t4 [midi::track -events $t4el]

# Add tracks and write file
$mf configure -tracks [list $t1 $t2 $t3 $t4]
$mf write test.mid
$mf destroy

exit
</pre></td></tr></table></p>

The following examples uses the <b class='cmd'>midi::file::measure</b> method to generate the
same note-on and note-off events as in the example above. This example requires
Tcl 8.5 because it uses the {*} operator.

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
lappend auto_path ..
package require Tcl 8.5
package require midi

# Create midi file and initialise time division info
set mf [midi::file -type 1 -time_division_type ticks_per_beat -ticks_per_beat 480]

# Control track
set t1el {}
lappend t1el [list 0 [midi::event text -value &quot;control track&quot;]]
lappend t1el [list 0 [midi::event tempo -tempo 0X7A120]] ;# 120 Beats per minute
lappend t1el [list 0 [midi::event end_of_track]]

set t1 [midi::track -events $t1el]

# Piano track
set at2el {}
lappend at2el [list 0 [midi::event text -value &quot;Piano track&quot;]]
lappend at2el [list 0 [midi::event program_change -channel 0 -program &quot;Electric Piano 2&quot;]]
lappend at2el {*}[$mf measure -channel 0 -events {{1/1 C4} {1/1 E4} {1/1 G4} {1/1 C5} {1/1 {C4 E4 G4 C5}}}]
lappend at2el [list 0 [midi::event end_of_track]]

set t2 [midi::track -events $at2el]

# Bass track
set at3el {}
lappend at3el [list 0 [midi::event text -value &quot;Bass track&quot;]]
lappend at3el [list 0 [midi::event program_change -channel 1 -program &quot;Electric Bass(pick)&quot;]]
lappend at3el {*}[$mf measure -channel 1 -events {{1/4 C2} {1/4 D2} {1/4 E2} {1/4 F2}}]
lappend at3el {*}[$mf measure -channel 1 -events {{1/4 E2 60} {1/4 F2} {1/4 G2} {1/4 A2}}]
lappend at3el {*}[$mf measure -channel 1 -events {{1/4 G2} {1/4 A2} {1/4 B2} {1/4  C3}}]
lappend at3el {*}[$mf measure -channel 1 -events {{1/2 C3} {1/4 G2} {1/4 E2}}]
lappend at3el {*}[$mf measure -channel 1 -events {{1/1 C2}}]
lappend at3el [list 0 [midi::event end_of_track]]

set t3 [midi::track -events $at3el]

# Drum track
set at4el {}
lappend at4el [list 0 [midi::event text -value &quot;Drum track&quot;]]
for { set i 0 } { $i &lt; 5 } { incr i } {
    lappend at4el {*}[$mf measure -channel 9 -events {
        {1/4 {&quot;closed hi-hat&quot; &quot;acoustic bass drum&quot;}} \
	{1/4 {&quot;closed hi-hat&quot;}} \
        {1/4 {&quot;closed hi-hat&quot; &quot;acoustic snare&quot;}} \
        {1/4 {&quot;closed hi-hat&quot;}} \
	}]
}
lappend at4el [list 0 [midi::event end_of_track]]

set t4 [midi::track -events $at4el]

# Add tracks and write file
$mf configure -tracks [list $t1 $t2 $t3 $t4]
$mf write test2.mid
$mf destroy

exit
</pre></td></tr></table></p>

This example shows how the rests and the <b class='cmd'>midi::merge</b> command can be used
to generate an event-list for the first track of the example above:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
set t1 [midi::track -events $t1el]

# Piano track
set at2el {}
lappend at2el [list 0 [midi::event text -value &quot;Piano track&quot;]]
lappend at2el [list 0 [midi::event program_change -channel 0 -program &quot;Electric Piano 2&quot;]]


set te1 [$mf measure -channel 0 -events {{1/1 C4} {1/1 r}  {1/1 G4} {1/1 R}  {1/1 {r  E4 r  C5}}}]
set te2 [$mf measure -channel 0 -events {{1/1 R}  {1/1 E4} {1/1 r}  {1/1 C5} {1/1 {C4 r  G4 r }}}]
lappend at2el {*}[midi::merge $te1 $te2]

lappend at2el [list 0 [midi::event end_of_track]]

set t2 [midi::track -events $at2el]
</pre></td></tr></table></p>

This example reads the midi file specified on the command line and dumps the
contents to standard output:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
package require midi

set mf [midi::file]
$mf read [lindex $argv 0]
puts [$mf dump]
$mf destroy

exit
</pre></td></tr></table></p>

The result of the dump command looks like this:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
MThd
  header size: 6
  format type: 1
  number of tracks: 4
  time division: 480 ticks per beat

MTrk

  Delta time    Absolute time Event
  ------------- ------------- ----------------------------------------
              0             0 text control track
              0             0 tempo 500000
              0             0 end_of_track

MTrk

  Delta time    Absolute time Event
  ------------- ------------- ----------------------------------------
              0             0 text Piano track
              0             0 program_change channel 0x00, program 0x04
              0             0 note_on channel 0x00, note 0x3C, velocity 0x7F
           1920          1920 note_off channel 0x00, note 0x3C, velocity 0x7F
              0          1920 note_on channel 0x00, note 0x40, velocity 0x7F
           1920          3840 note_off channel 0x00, note 0x40, velocity 0x7F
              0          3840 note_on channel 0x00, note 0x43, velocity 0x7F
           1920          5760 note_off channel 0x00, note 0x43, velocity 0x7F
              0          5760 note_on channel 0x00, note 0x48, velocity 0x7F
           1920          7680 note_off channel 0x00, note 0x48, velocity 0x7F
              0          7680 note_on channel 0x00, note 0x3C, velocity 0x7F
              0          7680 note_on channel 0x00, note 0x40, velocity 0x7F
              0          7680 note_on channel 0x00, note 0x43, velocity 0x7F
              0          7680 note_on channel 0x00, note 0x48, velocity 0x7F
           1920          9600 note_off channel 0x00, note 0x3C, velocity 0x7F
              0          9600 note_off channel 0x00, note 0x40, velocity 0x7F
              0          9600 note_off channel 0x00, note 0x43, velocity 0x7F
              0          9600 note_off channel 0x00, note 0x48, velocity 0x7F
              0          9600 end_of_track

MTrk

  Delta time    Absolute time Event
  ------------- ------------- ----------------------------------------
              0             0 text Bass track
              0             0 program_change channel 0x01, program 0x22
              0             0 note_on channel 0x01, note 0x24, velocity 0x7F
            480           480 note_off channel 0x01, note 0x24, velocity 0x7F
              0           480 note_on channel 0x01, note 0x26, velocity 0x7F
            480           960 note_off channel 0x01, note 0x26, velocity 0x7F
              0           960 note_on channel 0x01, note 0x28, velocity 0x7F
            480          1440 note_off channel 0x01, note 0x28, velocity 0x7F
              0          1440 note_on channel 0x01, note 0x29, velocity 0x7F
            480          1920 note_off channel 0x01, note 0x29, velocity 0x7F
              0          1920 note_on channel 0x01, note 0x28, velocity 0x7F
            480          2400 note_off channel 0x01, note 0x28, velocity 0x7F
              0          2400 note_on channel 0x01, note 0x29, velocity 0x7F
            480          2880 note_off channel 0x01, note 0x29, velocity 0x7F
              0          2880 note_on channel 0x01, note 0x2B, velocity 0x7F
            480          3360 note_off channel 0x01, note 0x2B, velocity 0x7F
              0          3360 note_on channel 0x01, note 0x2D, velocity 0x7F
            480          3840 note_off channel 0x01, note 0x2D, velocity 0x7F
              0          3840 note_on channel 0x01, note 0x2B, velocity 0x7F
            480          4320 note_off channel 0x01, note 0x2B, velocity 0x7F
              0          4320 note_on channel 0x01, note 0x2D, velocity 0x7F
            480          4800 note_off channel 0x01, note 0x2D, velocity 0x7F
              0          4800 note_on channel 0x01, note 0x2F, velocity 0x7F
            480          5280 note_off channel 0x01, note 0x2F, velocity 0x7F
              0          5280 note_on channel 0x01, note 0x30, velocity 0x7F
            480          5760 note_off channel 0x01, note 0x30, velocity 0x7F
              0          5760 note_on channel 0x01, note 0x30, velocity 0x7F
            960          6720 note_off channel 0x01, note 0x30, velocity 0x7F
              0          6720 note_on channel 0x01, note 0x2B, velocity 0x7F
            480          7200 note_off channel 0x01, note 0x2B, velocity 0x7F
              0          7200 note_on channel 0x01, note 0x28, velocity 0x7F
            480          7680 note_off channel 0x01, note 0x28, velocity 0x7F
              0          7680 note_on channel 0x01, note 0x24, velocity 0x7F
           1920          9600 note_off channel 0x01, note 0x24, velocity 0x7F
              0          9600 end_of_track

MTrk

  Delta time    Absolute time Event
  ------------- ------------- ----------------------------------------
              0             0 text Drum track
              0             0 note_on channel 0x09, note 0x2A, velocity 0x7F
              0             0 note_on channel 0x09, note 0x24, velocity 0x7F
            480           480 note_on channel 0x09, note 0x2A, velocity 0x7F
            480           960 note_on channel 0x09, note 0x2A, velocity 0x7F
              0           960 note_on channel 0x09, note 0x26, velocity 0x7F
            480          1440 note_on channel 0x09, note 0x2A, velocity 0x7F
            480          1920 note_on channel 0x09, note 0x2A, velocity 0x7F
              0          1920 note_on channel 0x09, note 0x24, velocity 0x7F
            480          2400 note_on channel 0x09, note 0x2A, velocity 0x7F
            480          2880 note_on channel 0x09, note 0x2A, velocity 0x7F
              0          2880 note_on channel 0x09, note 0x26, velocity 0x7F
            480          3360 note_on channel 0x09, note 0x2A, velocity 0x7F
            480          3840 note_on channel 0x09, note 0x2A, velocity 0x7F
              0          3840 note_on channel 0x09, note 0x24, velocity 0x7F
            480          4320 note_on channel 0x09, note 0x2A, velocity 0x7F
            480          4800 note_on channel 0x09, note 0x2A, velocity 0x7F
              0          4800 note_on channel 0x09, note 0x26, velocity 0x7F
            480          5280 note_on channel 0x09, note 0x2A, velocity 0x7F
            480          5760 note_on channel 0x09, note 0x2A, velocity 0x7F
              0          5760 note_on channel 0x09, note 0x24, velocity 0x7F
            480          6240 note_on channel 0x09, note 0x2A, velocity 0x7F
            480          6720 note_on channel 0x09, note 0x2A, velocity 0x7F
              0          6720 note_on channel 0x09, note 0x26, velocity 0x7F
            480          7200 note_on channel 0x09, note 0x2A, velocity 0x7F
            480          7680 note_on channel 0x09, note 0x2A, velocity 0x7F
              0          7680 note_on channel 0x09, note 0x24, velocity 0x7F
            480          8160 note_on channel 0x09, note 0x2A, velocity 0x7F
            480          8640 note_on channel 0x09, note 0x2A, velocity 0x7F
              0          8640 note_on channel 0x09, note 0x26, velocity 0x7F
            480          9120 note_on channel 0x09, note 0x2A, velocity 0x7F
              0          9120 end_of_track
</pre></td></tr></table></p>

<h2><a name="events">Events</a></h2>
<p>

<dl>

<dt>sequence_number<dd> Event containing the sequence number of the track in
 which this event is placed.

<br><br>
<dl>
<dt><strong>-value</strong> integer<dd> The sequence number of the track. The default value
is <strong>0</strong>. 
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>text<dd> Text describing the track in which this event is placed.

<br><br>
<dl>
<dt><strong>-value</strong> string<dd> File or track description. The default value is an 
empty string.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>copyright<dd> Midi file copyright notice.

<br><br>
<dl>
<dt><strong>-value</strong> string<dd> Copyright text. The default value is an empty 
string.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>track_name<dd> Name of track.

<br><br>
<dl>
<dt><strong>-value</strong> string<dd> Track name. The default value is an empty string.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>instrument_name<dd> Name of instrument used in track.

<br><br>
<dl>
<dt><strong>-value</strong> string<dd> Instrument name. The default value is an empty string.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>lyric<dd> Lyric to be sung at the point this event is placed. This can 
be a word or syllable.

<br><br>
<dl>
<dt><strong>-value</strong> string<dd> Lyric. The default value is an empty string.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>marker<dd> Marker for specific point in track like rehearsal letter, 
section name, loop start or loop end.

<br><br>
<dl>
<dt><strong>-value</strong> string<dd> Marker text. The default value is an empty string.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>cue_point<dd> Description of something which happens at the point this 
event is placed.

<br><br>
<dl>
<dt><strong>-value</strong> string<dd> Descriptive text. The default value is an empty string.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>program_name<dd> Name of the program used in the events following.

<br><br>
<dl>
<dt><strong>-value</strong> string<dd> Program name. The default value is an empty string.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>device_name<dd> Name of the midi device (port) where the track is 
routed.

<br><br>
<dl>
<dt><strong>-value</strong> string<dd> Device name. The default value is an empty string.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>channel<dd> Specifies the channel to which following meta and system 
exclusive must be sent. (DEPRECATED)

<br><br>
<dl>
<dt><strong>-channel</strong> integer<dd> Channel number. The default value is 0. Check the 
<a href="#channels">Channels</a> section for valid channel numbers.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>port<dd> Midi port to which following midi events must be sent. 
(DEPRECATED)

<br><br>
<dl>
<dt><strong>-port</strong><dd> Port number. The default value is 0.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>end_of_track<dd> Marks the end of a track. Must be placed at the end of 
every track. 

<br><br>
<dt>tempo<dd> Used to indicate tempo changes. 

<br><br>
<dl>
<dt><strong>-tempo</strong> integer<dd> Tempo expressed in micro seconds per quarter note. The
default value is 0x07A120 which corresponds to 120 BPM.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>smpte_offset<dd> Specifies the start time of the track. 

<br><br>
<dl>
<dt><strong>-hours</strong> integer<dd> Hours part of start time. Default value is 0.
<br><br>
<dt><strong>-minutes</strong> integer<dd> Minutes part of start time. Default value is 0.
<br><br>
<dt><strong>-seconds</strong> integer<dd> Seconds part of start time. Default value is 0.
<br><br>
<dt><strong>-frames</strong> integer<dd> Frame count part of start time. Default value is 0.
<br><br>
<dt><strong>-framefractions</strong> integer<dd> Frame fraction part of start time. Default 
value is 0.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>time_signature<dd> Used to specify the time signature.

<br><br>
<dl>
<dt><strong>-numerator</strong> integer<dd> Numerator part of time signature. Default value is
0.
<br><br>
<dt><strong>-denominator</strong> integer<dd> Denominator part of the time signature. This 
values must be an integer power of 2 (2, 4, 8). Default value is 1.
<br><br>
<dt><strong>-clocks_ticks_between_metronome_clicks</strong> integer<dd> The number of midi 
clock cliks in one metronome click. Default value is 0. 
<br><br>
<dt><strong>-notated_32nd_notes_in_quarter_note</strong> integer<dd> The number of notated 
32nd notes in a midi quarter note. Default value is 0.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>key_signature<dd> Sets the key signature.

<br><br>
<dl>
<dt><strong>-number_of_modifications</strong> integer<dd> The number of modifications. 
Positive  numbers (1..7) for sharps, negative numbers (-1..-7) for flats. 
Default value is 0.
<br><br>
<dt><strong>-scale</strong> integer<dd> Set to 0 for major scale or to 1 for minor scale. 
Default values is 0.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>sequencer_specific<dd> Used to send data to a sequencer. These events 
are not interpreted by this packages. 

<br><br>
<dl>
<dt><strong>-data</strong> listOfIntegers<dd> The data to be sent as a list of integers 
without the size of the data. Default value is an empty list. 
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>meta_unknown<dd> Meta event. These events are not interpreted by this 
packages. 

<br><br>
<dl>
<dt><strong>-meta_unknown_event_type</strong> integer<dd> Meta event type. Default values is 
0.
<br><br>
<dt><strong>-data</strong> listOfIntegers<dd> Data associated with the meta event specified as
a list of integers without the size of the data. Default value is an empty 
list.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>SysEx<dd> System exclusive event. These events are not interpreted by 
this packages. 

<br><br>
<dl>
<dt><strong>-sysex_event_type</strong><dd> System exclusive event type. Default values is 0.
<br><br>
<dt><strong>-data</strong><dd> Data associated with the system exclusive event specified as
a list of integers without the size of the data. Default value is an empty 
list.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>note_on<dd> Play a note.

<br><br>
<dl>
<dt><strong>-channel</strong> integer<dd> Channel on which to play the note. Check the 
<a href="#channels">Channels</a> section for valid channel numbers. Default value is 0.
<br><br>
<dt><strong>-note</strong> note<dd> Note to play. Check the <a href="#notes">Notes</a> section for 
valid note numbers and valid note names. Default value is 0. 
<br><br>
<dt><strong>-velocity</strong> integer<dd> Velocity (volume) with which to hit the note. Must 
be an integer in the range 0..127. Default value is 0.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>note_off<dd> Stop a note.

<br><br>
<dl>
<dt><strong>-channel</strong> integer<dd> Channel on which to stop the note. Check the 
<a href="#channels">Channels</a> section for valid channel numbers. Default value is 0.
<br><br>
<dt><strong>-note</strong> note<dd> Note to stop. Check the <a href="#notes">Notes</a> section for 
valid note numbers and valid note names. Default value is 0. 
<br><br>
<dt><strong>-velocity</strong> integer<dd> Velocity (volume) with which to stop the note. Must
be an integer in the range 0..127. Default value is 0.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>note_aftertouch<dd> Change the pressure with which the note is held 
down. This can be used to control effects (e.g. a vibrato).

<br><br>
<dl>
<dt><strong>-channel</strong> integer<dd> Channel on which to apply the aftertouch. Check the 
<a href="#channels">Channels</a> section for valid channel numbers. Default value is 0.
<br><br>
<dt><strong>-note</strong> note<dd> Note to apply aftertouch to. Check the <a href="#notes">Notes</a> 
section for  valid note numbers and valid note names. Default value is 0. 
<br><br>
<dt><strong>-amount</strong> integer<dd> Amount of aftertouch to apply to the note. Must
be an integer in the range 0..127. Default value is 0.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>controller<dd> Used to set the value of a controller (e.g. modulation 
wheel).

<br><br>
<dl>
<dt><strong>-channel</strong> integer<dd> Channel on which controller will have effect. Check 
the <a href="#channels">Channels</a> section for valid channel numbers. Default value is 0. 
<br><br>
<dt><strong>-controller</strong> controller<dd> Controller name or number. Check the 
<a href="#controllers">Controllers</a> section for valid controller names and numbers. Default 
value is 0.
<br><br>
<dt><strong>-value</strong> integer<dd> Value to be set for the specified controller. Must
be an integer in the range 0..127. Default value is 0.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>program_change<dd> change the program (patch, instrument) for a channel.

<br><br>
<dl>
<dt><strong>-channel</strong> integer<dd> Channel on which program change will have effect. 
Check  the <a href="#channels">Channels</a> section for valid channel numbers. Default value 
is 0. 
<br><br>
<dt><strong>-program</strong> program<dd> Program name or number. Check the 
<a href="#programs">Programs</a> section for valid program names and numbers. Default value 
is 0.
<br><br>
<dt><strong></strong><dd>
</dl>

<dt>channel_aftertouch<dd> Change the pressure with which all notes in the 
specified channel are held down. This can be used to control effects (e.g. a 
vibrato).

<br><br>
<dl>
<dt><strong>-channel</strong> integer<dd> Channel on which to apply the aftertouch. Check the 
<a href="#channels">Channels</a> section for valid channel numbers. Default value is 0.
<br><br>
<dt><strong>-amount</strong> integer<dd> Amount of aftertouch to apply to the channel. Must
be an integer in the range 0..127. Default value is 0.
<br><br>
<dt><strong></strong><dd>
</dl>


<dt>pitch_bend<dd> Used to change the pitch of all notes in a channel.

<br><br>
<dl>
<dt><strong>-channel</strong> integer<dd> Channel on which to apply the aftertouch. Check the 
<a href="#channels">Channels</a> section for valid channel numbers. Default value is 0.
<br><br>
<dt><strong>-amount</strong> integer<dd> Amount of bend. Must be an integer in the range 
-8192..8191. Values less than zero lower the pitch, values larger than zero 
increase the pitch. 
<br><br>
<dt><strong></strong><dd>
</dl>
 
</dl>

<h2><a name="channels">Channels</a></h2>
<p>

A midi file can store data for 16 channels. Valid channel numbers are in the 
range 0..15. Real channel numbers must be specified. Often midi channels are 
numbered starting from 1. When using this package, the first channel is channel
zero. 

<h2><a name="notes">Notes</a></h2>
<p>

A midi file knows 128 notes. They are represented by an integer in the range 
0..127. The note with number 69 is an A with pitch of 440Hz. 

Notes can be specified using their number or using an alphanumeric notation. 
This notation has the following structure:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
&lt;note&gt;&lt;modifiers&gt;&lt;octave&gt;
</pre></td></tr></table></p>

<ul>

<li>Valid notes are <strong>A</strong>, <strong>B</strong>, <strong>C</strong>, <strong>D</strong>, <strong>E</strong>,
<strong>F</strong> and <strong>G</strong>. The notes can be specified in upper or lower case. 

<br><br>
<li>Valid modifiers are <strong>#</strong> and <strong>b</strong>. The modifiers can be
specified in upper or lower case.

<br><br>
<li>Valid octaves are <strong>-1</strong> to 9.

</ul>

Some examples:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
A4
Bb7
F#3
C##4
abb3
e#b#b#b6
</pre></td></tr></table></p>

When representing notes with their numbers, valid notes are:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
Number Note  Octave
------ ----- ------
     0     C     -1
     1 C#/Db     -1
     2     D     -1
     3 D#/Eb     -1
     4     E     -1
     5     F     -1
     6 F#/Gb     -1
     7     G     -1
     8  G#Ab     -1
     9     A     -1
    10 A#/Bb     -1
    11     B     -1
    12     C      0
    13 C#/Db      0
    14     D      0
    15 D#/Eb      0
    16     E      0
    17     F      0
    18 F#/Gb      0
    19     G      0
    20  G#Ab      0
    21     A      0
    22 A#/Bb      0
    23     B      0
    24     C      1
    25 C#/Db      1
    26     D      1
    27 D#/Eb      1
    28     E      1
    29     F      1
    30 F#/Gb      1
    31     G      1
    32  G#Ab      1
    33     A      1
    34 A#/Bb      1
    35     B      1
    36     C      2
    37 C#/Db      2
    38     D      2
    39 D#/Eb      2
    40     E      2
    41     F      2
    42 F#/Gb      2
    43     G      2
    44  G#Ab      2
    45     A      2
    46 A#/Bb      2
    47     B      2
    48     C      3
    49 C#/Db      3
    50     D      3
    51 D#/Eb      3
    52     E      3
    53     F      3
    54 F#/Gb      3
    55     G      3
    56  G#Ab      3
    57     A      3
    58 A#/Bb      3
    59     B      3
    60     C      4
    61 C#/Db      4
    62     D      4
    63 D#/Eb      4
    64     E      4
    65     F      4
    66 F#/Gb      4
    67     G      4
    68  G#Ab      4
    69     A      4
    70 A#/Bb      4
    71     B      4
    72     C      5
    73 C#/Db      5
    74     D      5
    75 D#/Eb      5
    76     E      5
    77     F      5
    78 F#/Gb      5
    79     G      5
    80  G#Ab      5
    81     A      5
    82 A#/Bb      5
    83     B      5
    84     C      6
    85 C#/Db      6
    86     D      6
    87 D#/Eb      6
    88     E      6
    89     F      6
    90 F#/Gb      6
    91     G      6
    92  G#Ab      6
    93     A      6
    94 A#/Bb      6
    95     B      6
    96     C      7
    97 C#/Db      7
    98     D      7
    99 D#/Eb      7
   100     E      7
   101     F      7
   102 F#/Gb      7
   103     G      7
   104  G#Ab      7
   105     A      7
   106 A#/Bb      7
   107     B      7
   108     C      8
   109 C#/Db      8
   110     D      8
   111 D#/Eb      8
   112     E      8
   113     F      8
   114 F#/Gb      8
   115     G      8
   116  G#Ab      8
   117     A      8
   118 A#/Bb      8
   119     B      8
   120     C      9
   121 C#/Db      9
   122     D      9
   123 D#/Eb      9
   124     E      9
   125     F      9
   126 F#/Gb      9
   127     G      9
</pre></td></tr></table></p>

When playing a note on channel 9, one of the following percussion sound names 
can be used to specify the note:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
Number Sound
------ ------------------
    35 Acoustic Bass Drum     
    36 Bass Drum 1            
    37 Side Stick             
    38 Acoustic Snare         
    39 Hand Clap              
    40 Electric Snare         
    41 Low Floor Tom          
    42 Closed Hi-Hat          
    43 High Floor Tom         
    44 Pedal Hi-Hat           
    45 Low Tom                
    46 Open Hi-Hat            
    47 Low-Mid Tom            
    48 Hi-Mid Tom             
    49 Crash Cymbal 1         
    50 High Tom               
    51 Ride Cymbal 1          
    52 Chinese Cymbal         
    53 Ride Bell              
    54 Tambourine             
    55 Splash Cymbal          
    56 Cowbell                
    57 Crash Cymbal 2         
    58 Vibraslap
    59 Ride Cymbal 2      
    60 Hi Bongo           
    61 Low Bongo          
    62 Mute Hi Conga      
    63 Open Hi Conga      
    64 Low Conga          
    65 High Timbale       
    66 Low Timbale        
    67 High Agogo         
    68 Low Agogo          
    69 Cabasa             
    70 Maracas            
    71 Short Whistle      
    72 Long Whistle       
    73 Short Guiro        
    74 Long Guiro         
    75 Claves             
    76 Hi Wood Block      
    77 Low Wood Block     
    78 Mute Cuica         
    79 Open Cuica         
    80 Mute Triangle      
    81 Open Triangle      
</pre></td></tr></table></p>

These precussion sound names can be specified case insensitive.

<h2><a name="controllers">Controllers</a></h2>
<p>

Controllers can be specified with their name or number. Controller names are 
case insensitive. The defined controllers are:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
Ctrl Description
---- ---------------------------------------------
   0 Bank Select (coarse)                               
   1 Modulation Wheel (coarse)                          
   2 Breath controller (coarse)                         
   4 Foot Pedal (coarse)                                
   5 Portamento Time (coarse)                           
   6 Data Entry (coarse)                                
   7 Volume (coarse)                                    
   8 Balance (coarse)                                   
  10 Pan position (coarse)                              
  11 Expression (coarse)                                
  12 Effect Control 1 (coarse)                          
  13 Effect Control 2 (coarse)                          
  16 General Purpose Slider 1                           
  17 General Purpose Slider 2                           
  18 General Purpose Slider 3                           
  19 General Purpose Slider 4                           
  32 Bank Select (fine)                                 
  33 Modulation Wheel (fine)                            
  34 Breath controller (fine)                           
  36 Foot Pedal (fine)                                  
  37 Portamento Time (fine)                             
  38 Data Entry (fine)                                  
  39 Volume (fine)                                      
  40 Balance (fine)                                     
  42 Pan position (fine)                                
  43 Expression (fine)                                  
  44 Effect Control 1 (fine)                            
  45 Effect Control 2 (fine)                            
  64 Hold Pedal (on/off)                                
  65 Portamento (on/off)                                
  66 Sustenuto Pedal (on/off)                           
  67 Soft Pedal (on/off)                                
  68 Legato Pedal (on/off)                              
  69 Hold 2 Pedal (on/off)                              
  70 Sound Variation                                    
  71 Sound Timbre                                       
  72 Sound Release Time                                 
  73 Sound Attack Time                                  
  74 Sound Brightness                                   
  75 Sound Control 6                                    
  76 Sound Control 7                                    
  77 Sound Control 8                                    
  78 Sound Control 9                                    
  79 Sound Control 10                                   
  80 General Purpose Button 1 (on/off)                  
  81 General Purpose Button 2 (on/off)                  
  82 General Purpose Button 3 (on/off)                  
  83 General Purpose Button 4 (on/off)                  
  91 Effects Level                                      
  92 Tremulo Level                                      
  93 Chorus Level                                       
  94 Celeste Level                                      
  95 Phaser Level                                       
  96 ata Button increment                               
  97 Data Button decrement                              
  98 Non-registered Parameter (fine)                    
  99 Non-registered Parameter (coarse)                  
 100 Registered Parameter (fine)                        
 101 Registered Parameter (coarse)                      
 120 All Sound Off                                      
 121 All Controllers Off                                
 122 Local Keyboard (on/off)                            
 123 All Notes Off                                      
 124 Omni Mode Off                                      
 125 Omni Mode On                                       
 126 Mono Operation                                     
 127 Poly Operation                                     
</pre></td></tr></table></p>

<h2><a name="programs">Programs</a></h2>
<p>

Program names (also known as patches or instruments) can be specified with
their name or number. Names are case insensitive. Programs known in the General
Midi standard are:

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>
Program Family               Description
------- -------------------- -----------
      0 Piano                Acoustic Grand        
      1 Piano                Bright Acoustic       
      2 Piano                Electric Grand        
      3 Piano                Honky-Tonk            
      4 Piano                Electric Piano 1      
      5 Piano                Electric Piano 2      
      6 Piano                Harpsichord           
      7 Piano                Clavinet              
      8 Chromatic percussion Celesta      
      9 Chromatic percussion Glockenspiel 
     10 Chromatic percussion Music Box    
     11 Chromatic percussion Vibraphone   
     12 Chromatic percussion Marimba      
     13 Chromatic percussion Xylophone    
     14 Chromatic percussion Tubular Bells
     15 Chromatic percussion Dulcimer     
     16 Organ                Drawbar Organ         
     17 Organ                Percussive Organ      
     18 Organ                Rock Organ            
     19 Organ                Church Organ          
     20 Organ                Reed Organ            
     21 Organ                Accoridan             
     22 Organ                Harmonica             
     23 Organ                Tango Accordian       
     24 Guitar               Nylon String Guitar   
     25 Guitar               Steel String Guitar   
     26 Guitar               Electric Jazz Guitar  
     27 Guitar               Electric Clean Guitar 
     28 Guitar               Electric Muted Guitar 
     29 Guitar               Overdriven Guitar     
     30 Guitar               Distortion Guitar     
     31 Guitar               Guitar Harmonics      
     32 Bass                 Acoustic Bass             
     33 Bass                 Electric Bass(finger)     
     34 Bass                 Electric Bass(pick)       
     35 Bass                 Fretless Bass             
     36 Bass                 Slap Bass 1               
     37 Bass                 Slap Bass 2               
     38 Bass                 Synth Bass 1              
     39 Bass                 Synth Bass 2              
     40 Solo strings         Violin             
     41 Solo strings         Viola              
     42 Solo strings         Cello              
     43 Solo strings         Contrabass         
     44 Solo strings         Tremolo Strings    
     45 Solo strings         Pizzicato Strings  
     46 Solo strings         Orchestral Strings 
     47 Solo strings         Timpani            
     48 Ensemble             String Ensemble 1         
     49 Ensemble             String Ensemble 2         
     50 Ensemble             SynthStrings 1            
     51 Ensemble             SynthStrings 2            
     52 Ensemble             Choir Aahs                
     53 Ensemble             Voice Oohs                
     54 Ensemble             Synth Voice               
     55 Ensemble             Orchestra Hit             
     56 Brass                Trumpet        
     57 Brass                Trombone       
     58 Brass                Tuba           
     59 Brass                Muted Trumpet  
     60 Brass                French Horn    
     61 Brass                Brass Section  
     62 Brass                SynthBrass 1   
     63 Brass                SynthBrass 2   
     64 Reed                 Soprano Sax               
     65 Reed                 Alto Sax                  
     66 Reed                 Tenor Sax                 
     67 Reed                 Baritone Sax              
     68 Reed                 Oboe                      
     69 Reed                 English Horn              
     70 Reed                 Bassoon                   
     71 Reed                 Clarinet                  
     72 Pipe                 Piccolo     
     73 Pipe                 Flute       
     74 Pipe                 Recorder    
     75 Pipe                 Pan Flute   
     76 Pipe                 Blown Bottle
     77 Pipe                 Skakuhachi  
     78 Pipe                 Whistle     
     79 Pipe                 Ocarina     
     80 Synth lead           Lead 1 (square)           
     81 Synth lead           Lead 2 (sawtooth)         
     82 Synth lead           Lead 3 (calliope)         
     83 Synth lead           Lead 4 (chiff)            
     84 Synth lead           Lead 5 (charang)          
     85 Synth lead           Lead 6 (voice)            
     86 Synth lead           Lead 7 (fifths)           
     87 Synth lead           Lead 8 (bass+lead)        
     88 Synth pad            Pad 1 (new age)    
     89 Synth pad            Pad 2 (warm)      
     90 Synth pad            Pad 3 (polysynth) 
     91 Synth pad            Pad 4 (choir)     
     92 Synth pad            Pad 5 (bowed)     
     93 Synth pad            Pad 6 (metallic)  
     94 Synth pad            Pad 7 (halo)      
     95 Synth pad            Pad 8 (sweep)     
     96 Synth effects        FX 1 (rain)               
     97 Synth effects        FX 2 (soundtrack)         
     98 Synth effects        FX 3 (crystal)            
     99 Synth effects        FX 4 (atmosphere)         
    100 Synth effects        FX 5 (brightness)         
    101 Synth effects        FX 6 (goblins)            
    102 Synth effects        FX 7 (echoes)             
    103 Synth effects        FX 8 (sci-fi)              
    104 Ethnic               Sitar   
    105 Ethnic               Banjo   
    106 Ethnic               Shamisen
    107 Ethnic               Koto    
    108 Ethnic               Kalimba 
    109 Ethnic               Bagpipe 
    110 Ethnic               Fiddle  
    111 Ethnic               Shanai  
    112 Percussive           Tinkle Bell               
    113 Percussive           Agogo                     
    114 Percussive           Steel Drums               
    115 Percussive           Woodblock                 
    116 Percussive           Taiko Drum                
    117 Percussive           Melodic Tom               
    118 Percussive           Synth Drum                
    119 Percussive           Reverse Cymbal            
    120 Sound effects        Guitar Fret Noise
    121 Sound effects        Breath Noise     
    122 Sound effects        Seashore         
    123 Sound effects        Bird Tweet       
    124 Sound effects        Telephone Ring   
    125 Sound effects        Helicopter       
    126 Sound effects        Applause         
    127 Sound effects        Gunshot          
</pre></td></tr></table></p>

Some midi devices may provide different drum kits for channel 9. General midi 
provides only one. 
  


<h2><a name="keywords">KEYWORDS</a></h2>
<p>
midi
<h2><a name="copyright">COPYRIGHT</a></h2>
<p>
Copyright &copy; 2006-2008 Jos Decoster &lt;jos.decoster@gmail.com&gt;<br>
</body></html>

